<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHP Decisor Universal</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="app-header">
            <h1>üéØ AHP Decisor Universal</h1>
            <p class="subtitle">M√©todo Anal√≠tico de Hierarquia para Decis√µes Complexas</p>
        </header>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Objetivo</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Crit√©rios</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Alternativas</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Julgamentos</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">Resultados</div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Passo 1: Objetivo -->
            <section id="step-1" class="step-content active">
                <h2>üìå Defina o Objetivo da Decis√£o</h2>
                <p class="help-text">Descreva o que voc√™ deseja alcan√ßar ou decidir</p>
                <div class="form-group">
                    <label for="objective-input">Objetivo:</label>
                    <input type="text" id="objective-input" placeholder="Ex: Comprar um Carro Novo" class="input-field">
                    <small class="input-hint">Seja claro e espec√≠fico sobre sua decis√£o</small>
                </div>
                <div class="actions">
                    <div class="actions-left">
                        <button class="btn btn-secondary" id="load-project-btn">üìÇ Carregar Projeto</button>
                        <button class="btn btn-secondary" onclick="openImportModal()">üì• Importar Arquivo</button>
                    </div>
                    <button class="btn btn-primary" onclick="nextStep()">Pr√≥ximo ‚Üí</button>
                </div>
            </section>

            <!-- Passo 2: Crit√©rios -->
            <section id="step-2" class="step-content">
                <h2>üìä Defina os Crit√©rios de Avalia√ß√£o</h2>
                <p class="help-text">Adicione os fatores importantes para sua decis√£o (m√≠nimo 2, m√°ximo 10)</p>
                <div class="ahp-info-box">
                    <strong>‚öñÔ∏è M√©todo AHP (Analytic Hierarchy Process)</strong>
                    <p>No pr√≥ximo passo, voc√™ comparar√° estes crit√©rios par a par. O sistema calcular√° automaticamente os pesos atrav√©s do m√©todo matem√°tico de Saaty.</p>
                </div>
                <div class="form-group">
                    <div class="input-with-button">
                        <input type="text" id="criteria-input" placeholder="Ex: Pre√ßo, Seguran√ßa, Consumo" class="input-field">
                        <button class="btn btn-add" onclick="addCriterion()">‚ûï Adicionar</button>
                    </div>
                </div>
                <div id="criteria-list" class="items-list"></div>
                <div class="actions">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="nextStep()">Pr√≥ximo ‚Üí</button>
                </div>
            </section>

            <!-- Passo 3: Alternativas -->
            <section id="step-3" class="step-content">
                <h2>üé≤ Defina as Alternativas</h2>
                <p class="help-text">Adicione as op√ß√µes que ser√£o avaliadas (m√≠nimo 2, m√°ximo 10)</p>
                <div class="ahp-info-box">
                    <strong>‚öñÔ∏è M√©todo AHP (Analytic Hierarchy Process)</strong>
                    <p>No pr√≥ximo passo, voc√™ comparar√° estas alternativas par a par para cada crit√©rio. Os desempenhos ser√£o calculados automaticamente.</p>
                </div>
                <div class="form-group">
                    <div class="input-with-button">
                        <input type="text" id="alternative-input" placeholder="Ex: Modelo X, Modelo Y, Modelo Z" class="input-field">
                        <button class="btn btn-add" onclick="addAlternative()">‚ûï Adicionar</button>
                    </div>
                </div>
                <div id="alternatives-list" class="items-list"></div>
                <div class="actions">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="nextStep()">Pr√≥ximo ‚Üí</button>
                </div>
            </section>

            <!-- Passo 4: Julgamentos -->
            <section id="step-4" class="step-content">
                <h2>‚öñÔ∏è Julgamentos Par a Par</h2>
                <p class="help-text">Compare os elementos usando a Escala de Saaty</p>
                
                <!-- Tabs for Criteria vs Alternatives -->
                <div class="tabs">
                    <button class="tab-button active" data-tab="criteria-judgments">Comparar Crit√©rios</button>
                    <button class="tab-button" data-tab="alternatives-judgments">Comparar Alternativas</button>
                </div>

                <!-- Criteria Judgments -->
                <div id="criteria-judgments" class="tab-content active">
                    <div class="judgments-header">
                        <h3>Compara√ß√£o dos Crit√©rios</h3>
                        <p>Em rela√ß√£o ao objetivo: <strong id="objective-display-1"></strong></p>
                    </div>
                    
                    <!-- √çndice de Consist√™ncia FIXO no Topo -->
                    <div class="consistency-realtime-panel sticky">
                        <div class="consistency-compact">
                            <div class="consistency-title">
                                <span class="icon">üìä</span>
                                <span>√çndice de Consist√™ncia em Tempo Real</span>
                            </div>
                            <div id="criteria-consistency" class="consistency-metrics-compact"></div>
                        </div>
                    </div>
                    
                    <div id="criteria-comparisons" class="comparisons-container"></div>
                </div>

                <!-- Alternatives Judgments -->
                <div id="alternatives-judgments" class="tab-content">
                    <div class="judgments-header">
                        <h3>Compara√ß√£o das Alternativas</h3>
                        <div class="criterion-selector">
                            <label>Crit√©rio atual:</label>
                            <select id="current-criterion" class="select-field"></select>
                        </div>
                    </div>
                    
                    <!-- √çndice de Consist√™ncia FIXO no Topo -->
                    <div class="consistency-realtime-panel sticky">
                        <div class="consistency-compact">
                            <div class="consistency-title">
                                <span class="icon">üìä</span>
                                <span>√çndice de Consist√™ncia - Crit√©rio Atual</span>
                            </div>
                            <div id="alternatives-consistency" class="consistency-metrics-compact"></div>
                        </div>
                    </div>
                    
                    <div id="alternatives-comparisons" class="comparisons-container"></div>
                </div>

                <div class="actions">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Anterior</button>
                    <button class="btn btn-primary" onclick="calculateResults()">Calcular Resultados ‚Üí</button>
                </div>
            </section>

            <!-- Passo 5: Resultados -->
            <section id="step-5" class="step-content">
                <h2>üèÜ Resultados da An√°lise AHP</h2>
                
                <!-- Tabs de Resultados -->
                <div class="tabs results-tabs">
                    <button class="tab-button active" data-tab="results-main">üìä Resultados Principais</button>
                    <button class="tab-button" data-tab="results-sensitivity">üìà An√°lise de Sensibilidade</button>
                </div>

                <!-- Tab: Resultados Principais -->
                <div id="results-main" class="tab-content active">
                    <div class="results-overview">
                        <div class="result-card">
                            <h3>Ranking das Alternativas</h3>
                            <div id="ranking-list" class="ranking-container"></div>
                        </div>

                        <div class="result-card">
                            <h3>Distribui√ß√£o de Prioridades</h3>
                            <canvas id="priorities-chart"></canvas>
                        </div>
                    </div>

                    <div class="result-card">
                        <h3>An√°lise Detalhada por Crit√©rio</h3>
                        <div id="detailed-analysis" class="detailed-table"></div>
                    </div>

                    <div class="result-card">
                        <h3>Pesos dos Crit√©rios</h3>
                        <canvas id="criteria-chart"></canvas>
                    </div>
                </div>

                <!-- Tab: An√°lise de Sensibilidade -->
                <div id="results-sensitivity" class="tab-content">
                    <div class="sensitivity-info">
                        <p class="help-text">
                            üìà A an√°lise de sensibilidade mostra como o ranking mudaria se voc√™ alterasse os pesos dos crit√©rios. 
                            Isso ajuda a entender a robustez da sua decis√£o.
                        </p>
                    </div>

                    <div class="result-card">
                        <h3>üéØ An√°lise Interativa - Ajuste os Pesos</h3>
                        <p class="help-text">Mova os sliders para ver como o ranking muda em tempo real</p>
                        <div id="sensitivity-sliders" class="sensitivity-sliders-container"></div>
                        <div class="sensitivity-summary">
                            <div class="weight-total-display">
                                <span>Soma dos pesos:</span>
                                <span id="sensitivity-total" class="weight-total">100%</span>
                            </div>
                        </div>
                    </div>

                    <div class="result-card">
                        <h3>üìä Ranking Din√¢mico</h3>
                        <div id="sensitivity-ranking" class="ranking-container"></div>
                    </div>

                    <div class="results-overview">
                        <div class="result-card">
                            <h3>üå™Ô∏è Gr√°fico de Tornado - Sensibilidade por Crit√©rio</h3>
                            <p class="help-text">Mostra o impacto de variar cada crit√©rio em ¬±20%</p>
                            <canvas id="tornado-chart"></canvas>
                        </div>

                        <div class="result-card">
                            <h3>üìâ Linhas de Sensibilidade</h3>
                            <p class="help-text">Como cada alternativa varia ao mudar um crit√©rio espec√≠fico</p>
                            <div class="form-group">
                                <label>Selecione o crit√©rio para an√°lise:</label>
                                <select id="sensitivity-criterion-select" class="select-field" onchange="renderSensitivityLines()">
                                </select>
                            </div>
                            <canvas id="sensitivity-lines-chart"></canvas>
                        </div>
                    </div>

                    <div class="result-card">
                        <h3>üéØ Pontos Cr√≠ticos</h3>
                        <div id="critical-points" class="critical-points-container"></div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Anterior</button>
                    <div class="actions-center">
                        <button class="btn btn-success" id="save-project-btn">üíæ Salvar Projeto</button>
                        <button class="btn btn-info" onclick="exportAnalysis()">üì§ Exportar Arquivo</button>
                    </div>
                    <button class="btn btn-primary" onclick="resetApp()">üîÑ Nova An√°lise</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Loading Projects -->
    <div id="load-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoadModal()">&times;</span>
            <h2>üìÇ Projetos Salvos</h2>
            <div id="projects-list"></div>
        </div>
    </div>

    <!-- Modal for Importing Analysis -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeImportModal()">&times;</span>
            <h2>üì• Importar An√°lise</h2>
            <p class="help-text">Selecione um arquivo JSON exportado anteriormente</p>
            
            <div class="import-file-section">
                <label for="import-file-input" class="file-input-label">
                    <span class="file-icon">üìÑ</span>
                    <span class="file-text">Escolher arquivo JSON</span>
                </label>
                <input type="file" id="import-file-input" accept=".json" onchange="handleImportFileSelect(event)" hidden>
            </div>
            
            <div class="import-preview-section">
                <h3>üìã Pr√©-visualiza√ß√£o</h3>
                <div id="import-preview">
                    <p class="empty-message">Selecione um arquivo JSON para visualizar.</p>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeImportModal()">Cancelar</button>
                <button class="btn btn-success" id="confirm-import-btn" onclick="confirmImport()" disabled>‚úì Confirmar Importa√ß√£o</button>
            </div>
        </div>
    </div>

    <!-- Saaty Scale Reference -->
    <div class="scale-reference">
        <button class="scale-toggle" onclick="toggleScaleReference()">‚ùì Escala de Saaty</button>
        <div class="scale-content" id="scale-content">
            <h4>Escala Fundamental de Saaty</h4>
            <table>
                <tr><th>Valor</th><th>Defini√ß√£o</th></tr>
                <tr><td>1</td><td>Igual import√¢ncia</td></tr>
                <tr><td>3</td><td>Import√¢ncia moderada</td></tr>
                <tr><td>5</td><td>Import√¢ncia forte</td></tr>
                <tr><td>7</td><td>Import√¢ncia muito forte</td></tr>
                <tr><td>9</td><td>Import√¢ncia extrema</td></tr>
                <tr><td>2, 4, 6, 8</td><td>Valores intermedi√°rios</td></tr>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="ahp.js"></script>
    <script src="app.js"></script>
</body>
</html>

